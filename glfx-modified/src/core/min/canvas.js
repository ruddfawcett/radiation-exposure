function clamp(e,t,r){return Math.max(e,Math.min(t,r))}function wrapTexture(e){return{_:e,loadContentsOf:function(e){gl=this._.gl,this._.loadContentsOf(e)},destroy:function(){gl=this._.gl,this._.destroy()}}}function texture(e){return wrapTexture(Texture.fromElement(e))}function initialize(e,t){var r=gl.UNSIGNED_BYTE;if(gl.getExtension("OES_texture_float")&&gl.getExtension("OES_texture_float_linear")){var i=new Texture(100,100,gl.RGBA,gl.FLOAT);try{i.drawTo(function(){r=gl.FLOAT})}catch(e){}i.destroy()}this._.texture&&this._.texture.destroy(),this._.spareTexture&&this._.spareTexture.destroy(),this.width=e,this.height=t,this._.texture=new Texture(e,t,gl.RGBA,r),this._.spareTexture=new Texture(e,t,gl.RGBA,r),this._.extraTexture=this._.extraTexture||new Texture(0,0,gl.RGBA,r),this._.flippedShader=this._.flippedShader||new Shader(null,"        uniform sampler2D texture;        varying vec2 texCoord;        void main() {            gl_FragColor = texture2D(texture, vec2(texCoord.x, 1.0 - texCoord.y));        }    "),this._.isInitialized=!0}function draw(e,t,r){return this._.isInitialized&&e._.width==this.width&&e._.height==this.height||initialize.call(this,t||e._.width,r||e._.height),e._.use(),this._.texture.drawTo(function(){Shader.getDefaultShader().drawRect()}),this}function update(){return this._.texture.use(),this._.flippedShader.drawRect(),this}function simpleShader(e,t,r,i){(r||this._.texture).use(),this._.spareTexture.drawTo(function(){e.uniforms(t).drawRect()}),this._.spareTexture.swapWith(i||this._.texture)}function replace(e){return e.parentNode.insertBefore(this,e),e.parentNode.removeChild(e),this}function contents(){var e=new Texture(this._.texture.width,this._.texture.height,gl.RGBA,gl.UNSIGNED_BYTE);return this._.texture.use(),e.drawTo(function(){Shader.getDefaultShader().drawRect()}),wrapTexture(e)}function getPixelArray(){var e=this._.texture.width,t=this._.texture.height,r=new Uint8Array(e*t*4);return this._.texture.drawTo(function(){gl.readPixels(0,0,e,t,gl.RGBA,gl.UNSIGNED_BYTE,r)}),r}function wrap(e){return function(){return gl=this._.gl,e.apply(this,arguments)}}var gl;exports.canvas=function(){var e=document.createElement("canvas");try{gl=e.getContext("experimental-webgl",{premultipliedAlpha:!0})}catch(e){gl=null}if(!gl)throw"This browser does not support WebGL";return e._={gl:gl,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null},e.texture=wrap(texture),e.draw=wrap(draw),e.update=wrap(update),e.replace=wrap(replace),e.contents=wrap(contents),e.getPixelArray=wrap(getPixelArray),e.brightnessContrast=wrap(brightnessContrast),e.hexagonalPixelate=wrap(hexagonalPixelate),e.hueSaturation=wrap(hueSaturation),e.colorHalftone=wrap(colorHalftone),e.triangleBlur=wrap(triangleBlur),e.unsharpMask=wrap(unsharpMask),e.perspective=wrap(perspective),e.matrixWarp=wrap(matrixWarp),e.bulgePinch=wrap(bulgePinch),e.tiltShift=wrap(tiltShift),e.dotScreen=wrap(dotScreen),e.edgeWork=wrap(edgeWork),e.lensBlur=wrap(lensBlur),e.zoomBlur=wrap(zoomBlur),e.noise=wrap(noise),e.denoise=wrap(denoise),e.curves=wrap(curves),e.swirl=wrap(swirl),e.ink=wrap(ink),e.vignette=wrap(vignette),e.vibrance=wrap(vibrance),e.sepia=wrap(sepia),e},exports.splineInterpolate=splineInterpolate;