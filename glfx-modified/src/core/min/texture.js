var Texture=function(){function t(t,e,i,h){this.gl=gl,this.id=gl.createTexture(),this.width=t,this.height=e,this.format=i,this.type=h,gl.bindTexture(gl.TEXTURE_2D,this.id),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),t&&e&&gl.texImage2D(gl.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null)}function e(t){return null==i&&(i=document.createElement("canvas")),i.width=t.width,i.height=t.height,c}t.fromElement=function(e){var i=new t(0,0,gl.RGBA,gl.UNSIGNED_BYTE);return i.loadContentsOf(e),i},t.prototype.loadContentsOf=function(t){this.width=t.width||t.videoWidth,this.height=t.height||t.videoHeight,gl.bindTexture(gl.TEXTURE_2D,this.id),gl.texImage2D(gl.TEXTURE_2D,0,this.format,this.format,this.type,t)},t.prototype.initFromBytes=function(t,e,i){this.width=t,this.height=e,this.format=gl.RGBA,this.type=gl.UNSIGNED_BYTE,gl.bindTexture(gl.TEXTURE_2D,this.id),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,t,e,0,gl.RGBA,this.type,new Uint8Array(i))},t.prototype.destroy=function(){gl.deleteTexture(this.id),this.id=null},t.prototype.use=function(t){gl.activeTexture(gl.TEXTURE0+(t||0)),gl.bindTexture(gl.TEXTURE_2D,this.id)},t.prototype.unuse=function(t){gl.activeTexture(gl.TEXTURE0+(t||0)),gl.bindTexture(gl.TEXTURE_2D,null)},t.prototype.ensureFormat=function(t,e,i,h){if(1==arguments.length){var g=arguments[0];t=g.width,e=g.height,i=g.format,h=g.type}t==this.width&&e==this.height&&i==this.format&&h==this.type||(this.width=t,this.height=e,this.format=i,this.type=h,gl.bindTexture(gl.TEXTURE_2D,this.id),gl.texImage2D(gl.TEXTURE_2D,0,this.format,t,e,0,this.format,this.type,null))},t.prototype.drawTo=function(t){if(gl.framebuffer=gl.framebuffer||gl.createFramebuffer(),gl.bindFramebuffer(gl.FRAMEBUFFER,gl.framebuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.id,0),gl.checkFramebufferStatus(gl.FRAMEBUFFER)!==gl.FRAMEBUFFER_COMPLETE)throw new Error("incomplete framebuffer");gl.viewport(0,0,this.width,this.height),t(),gl.bindFramebuffer(gl.FRAMEBUFFER,null)};var i=null;return t.prototype.fillUsingCanvas=function(t){return t(e(this)),this.format=gl.RGBA,this.type=gl.UNSIGNED_BYTE,gl.bindTexture(gl.TEXTURE_2D,this.id),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,i),this},t.prototype.toImage=function(t){this.use(),Shader.getDefaultShader().drawRect();var h=this.width*this.height*4,g=new Uint8Array(h),r=e(this),l=r.createImageData(this.width,this.height);gl.readPixels(0,0,this.width,this.height,gl.RGBA,gl.UNSIGNED_BYTE,g);for(var E=0;E<h;E++)l.data[E]=g[E];r.putImageData(l,0,0),t.src=i.toDataURL()},t.prototype.swapWith=function(t){var e;e=t.id,t.id=this.id,this.id=e,e=t.width,t.width=this.width,this.width=e,e=t.height,t.height=this.height,this.height=e,e=t.format,t.format=this.format,this.format=e},t}();